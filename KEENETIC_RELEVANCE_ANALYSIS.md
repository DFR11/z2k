# –ê–Ω–∞–ª–∏–∑ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –¥–ª—è Keenetic

## üî¥ –ö–†–ò–¢–ò–ß–ù–´–ï (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å)

### 1. check_system() - ‚úÖ –†–ï–õ–ï–í–ê–ù–¢–ù–û
**–ü–æ—á–µ–º—É:** –ú–æ–¥—É–ª–∏ common/ —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ SYSTEM, UNAME –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã
**Keenetic —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞:** –ù—É–∂–Ω–æ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ init —Å–∏—Å—Ç–µ–º—ã (–Ω–µ systemd, –Ω–µ openrc - custom)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ MUST FIX

### 2. crontab_add() - ‚úÖ –†–ï–õ–ï–í–ê–ù–¢–ù–û
**–ü–æ—á–µ–º—É:** –°–ø–∏—Å–∫–∏ –¥–æ–º–µ–Ω–æ–≤ –æ—Ç –†–ö–ù –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ
**Keenetic —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞:** –†–æ—É—Ç–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç 24/7, –∏–¥–µ–∞–ª—å–Ω–æ –¥–ª—è cron –∑–∞–¥–∞—á
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ MUST FIX

---

## üü° –í–ê–ñ–ù–´–ï (–¥–æ–±–∞–≤–∏—Ç—å –¥–ª—è production)

### 3. ask_config_tmpdir() - ‚úÖ –†–ï–õ–ï–í–ê–ù–¢–ù–û
**–ü–æ—á–µ–º—É:** Keenetic —Ä–æ—É—Ç–µ—Ä—ã —á–∞—Å—Ç–æ –∏–º–µ—é—Ç 128-256MB RAM
**Keenetic —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞:** /tmp —ç—Ç–æ tmpfs (–≤ –ø–∞–º—è—Ç–∏!), –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –º–æ–≥—É—Ç –≤—ã–∑–≤–∞—Ç—å OOM
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° SHOULD FIX
**–†–µ—à–µ–Ω–∏–µ:** –ù–∞ Keenetic ‚â§400MB RAM –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å /opt/zapret2/tmp –≤–º–µ—Å—Ç–æ /tmp

### 4. dry_run_nfqws() - ‚úÖ –†–ï–õ–ï–í–ê–ù–¢–ù–û
**–ü–æ—á–µ–º—É:** –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–ø—Ü–∏–π –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º
**Keenetic —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–≤–æ–¥—è—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏, –Ω—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° SHOULD FIX

### 5. select_ipv6() - ‚úÖ –†–ï–õ–ï–í–ê–ù–¢–ù–û
**–ü–æ—á–µ–º—É:** –ú–Ω–æ–≥–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –¥–∞—é—Ç IPv6 (–†–æ—Å—Ç–µ–ª–µ–∫–æ–º, –ú–¢–°, –ë–∏–ª–∞–π–Ω)
**Keenetic —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ IPv6 –µ—Å—Ç—å, –Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é z2k —Å—Ç–∞–≤–∏—Ç DISABLE_IPV6=1
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° SHOULD FIX
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –≤ –º–µ–Ω—é –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–∫–ª—é—á–∏—Ç—å IPv6

### 6. ask_config_offload() - ‚úÖ –†–ï–õ–ï–í–ê–ù–¢–ù–û
**–ü–æ—á–µ–º—É:** Flow offloading –ö–†–ò–¢–ò–ß–ù–û –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –Ω–∞ Keenetic
**Keenetic —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞:**
  - –ë–µ–∑ offloading: ~100-200 Mbps
  - –° software offloading: ~300-500 Mbps
  - –ù–û nfqws —Ç—Ä–∞—Ñ–∏–∫ –î–û–õ–ñ–ï–ù –±—ã—Ç—å –∏—Å–∫–ª—é—á—ë–Ω –∏–∑ offloading
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° SHOULD FIX
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** z2k —Å—Ç–∞–≤–∏—Ç FLOWOFFLOAD=none (–±–µ–∑–æ–ø–∞—Å–Ω–æ –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–æ)

---

## üü¢ –ü–û–õ–ï–ó–ù–´–ï (–¥–æ–±–∞–≤–∏—Ç—å –¥–ª—è UX)

### 7. fix_perms() - ‚úÖ –†–ï–õ–ï–í–ê–ù–¢–ù–û
**–ü–æ—á–µ–º—É:** –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª—ã –≤–∞–∂–Ω—ã –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
**Keenetic —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞:** Entware –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ñ–∞–π–ª—ã —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ NICE TO HAVE

### 8. default_files() - ‚úÖ –†–ï–õ–ï–í–ê–ù–¢–ù–û
**–ü–æ—á–µ–º—É:** Template —Ñ–∞–π–ª—ã —É–ø—Ä–æ—â–∞—é—Ç –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—é
**Keenetic —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞:**
  - zapret-hosts-user.txt
  - zapret-hosts-user-exclude.txt
  - custom.d/ scripts
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ NICE TO HAVE

### 9. backup_restore_settings() - ‚úÖ –†–ï–õ–ï–í–ê–ù–¢–ù–û
**–ü–æ—á–µ–º—É:** –ü—Ä–∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–µ –Ω–µ —Ç–µ—Ä—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
**Keenetic —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —á–∞—Å—Ç–æ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—à–∏–≤–∫–∏
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ NICE TO HAVE

### 10. CUSTOM_DIR creation - ‚úÖ –†–ï–õ–ï–í–ê–ù–¢–ù–û
**–ü–æ—á–µ–º—É:** –î–ª—è custom scripts –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
**Keenetic —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞:** init.d/keenetic/custom.d/ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ NICE TO HAVE

---

## ‚ùå –ù–ï –†–ï–õ–ï–í–ê–ù–¢–ù–´–ï (–ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å)

### 11. check_virt() - ‚ùå –ù–ï –†–ï–õ–ï–í–ê–ù–¢–ù–û
**–ü–æ—á–µ–º—É:** Keenetic - —ç—Ç–æ –∂–µ–ª–µ–∑–Ω—ã–π —Ä–æ—É—Ç–µ—Ä, –Ω–µ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å

### 12. ask_config() - ‚ùå –ù–ï –†–ï–õ–ï–í–ê–ù–¢–ù–û
**–ü–æ—á–µ–º—É:** z2k –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥—Ä—É–≥–æ–π –ø–æ–¥—Ö–æ–¥ - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é
**–†–µ—à–µ–Ω–∏–µ:** –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ª—É—á—à–µ –¥–ª—è UX

### 13. select_getlist() - ‚ùå –ù–ï –†–ï–õ–ï–í–ê–ù–¢–ù–û
**–ü–æ—á–µ–º—É:** z2k –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –∏–∑ zapret4rocket
**–†–µ—à–µ–Ω–∏–µ:** –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—â–µ

### 14. ws_opt_validate() - ‚ùå –ü–û–ö–†–´–¢–û
**–ü–æ—á–µ–º—É:** dry_run_nfqws() —É–∂–µ –¥–µ–ª–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–≤–µ—Ä–∫—É
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å dry_run_nfqws()

### 15. check_readonly_system() - ‚ùå –ù–ï –†–ï–õ–ï–í–ê–ù–¢–ù–û
**–ü–æ—á–µ–º—É:** Keenetic –Ω–µ read-only —Å–∏—Å—Ç–µ–º–∞ (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö OpenWrt —Å–±–æ—Ä–æ–∫)
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å

### 16. UNAME —É—Å—Ç–∞–Ω–æ–≤–∫–∞ - ‚ùå –ü–û–ö–†–´–¢–û
**–ü–æ—á–µ–º—É:** check_system() —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç UNAME
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å check_system()

---

## üìä –ò–¢–û–ì–û–í–´–ô –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (–±–ª–æ–∫–µ—Ä—ã PRE-ALPHA ‚Üí ALPHA)
1. ‚úÖ check_system() - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
2. ‚úÖ crontab_add() - –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤

### –§–∞–∑–∞ 2: –í–∞–∂–Ω—ã–µ (–±–ª–æ–∫–µ—Ä—ã ALPHA ‚Üí BETA)
3. ‚úÖ ask_config_tmpdir() - –∑–∞—â–∏—Ç–∞ low RAM —Å–∏—Å—Ç–µ–º
4. ‚úÖ dry_run_nfqws() - –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ–ø—Ü–∏–π
5. ‚úÖ select_ipv6() - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ IPv6 –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
6. ‚úÖ ask_config_offload() - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏

### –§–∞–∑–∞ 3: –ü–æ–ª–µ–∑–Ω—ã–µ (—É–ª—É—á—à–µ–Ω–∏—è UX –¥–ª—è BETA ‚Üí v1.0)
7. ‚úÖ fix_perms() - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª—ã
8. ‚úÖ default_files() - template —Ñ–∞–π–ª—ã
9. ‚úÖ backup_restore_settings() - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
10. ‚úÖ CUSTOM_DIR - –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è custom scripts

### –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å
- check_virt()
- ask_config()
- select_getlist()
- check_readonly_system()

---

**–í—ã–≤–æ–¥:** –ò–∑ 16 –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ä–∞–∑–ª–∏—á–∏–π, **10 —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã** –¥–ª—è Keenetic –∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω—ã.
