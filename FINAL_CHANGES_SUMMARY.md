# üìã –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è z2k

**–î–∞—Ç–∞:** 2026-01-28
**–í–µ—Ä—Å–∏—è:** z2k v2.0 ‚Üí v2.1 (–≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ ALPHA —Ä–µ–ª–∏–∑—É)

---

## üéØ –¶–ï–õ–¨

–£—Å—Ç—Ä–∞–Ω–∏—Ç—å —Ä–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É z2k –∏ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º `install_easy.sh`, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –Ω–∞—Ä—É—à–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –Ω–∞ Keenetic —Ä–æ—É—Ç–µ—Ä–∞—Ö.

**–ü—Ä–∏–Ω—Ü–∏–ø:** z2k - —ç—Ç–æ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫** –¥–ª—è Keenetic, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å "–∏–∑ –∫–æ—Ä–æ–±–∫–∏" –±–µ–∑ –≤–æ–ø—Ä–æ—Å–æ–≤ —é–∑–µ—Ä—É.

---

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û: 6 –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (–±–ª–æ–∫–µ—Ä—ã PRE-ALPHA ‚Üí ALPHA)

#### 1. init_system_vars() - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–æ–¥—É–ª–∏ `common/` —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ SYSTEM, UNAME, INIT –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã
**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å `lib/system_init.sh` —Å –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º —Ç–∏–ø–∞ —Å–∏—Å—Ç–µ–º—ã
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```bash
SYSTEM=openwrt  # –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
UNAME=Linux
INIT=procd
```

---

#### 2. crontab_add() - –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ –¥–æ–º–µ–Ω–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** –°–ø–∏—Å–∫–∏ –¥–æ–º–µ–Ω–æ–≤ –æ—Ç –†–ö–ù –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è ‚Üí –Ω–æ–≤—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ `crontab_add 0 6` –≤ `step_finalize()`
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```bash
# –í crontab –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
0 6 * * * /opt/zapret2/ipset/get_config.sh
```

---

### üü° –í–∞–∂–Ω—ã–µ (production –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å)

#### 3. step_configure_tmpdir() - –∑–∞—â–∏—Ç–∞ low RAM —Å–∏—Å—Ç–µ–º
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–∞ —Ä–æ—É—Ç–µ—Ä–∞—Ö ‚â§400MB RAM /tmp (tmpfs) –ø–µ—Ä–µ–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–ø–∏—Å–∫–æ–≤
**–†–µ—à–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä TMPDIR –Ω–∞ –æ—Å–Ω–æ–≤–µ RAM (–ë–ï–ó –≤–æ–ø—Ä–æ—Å–æ–≤)
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```bash
# –î–ª—è low RAM (‚â§400MB):
TMPDIR=/opt/zapret2/tmp

# –î–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ RAM (>400MB):
TMPDIR=""  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –±—ã—Å—Ç—Ä—ã–π /tmp
```

---

#### 4. dry_run_nfqws() - –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ–ø—Ü–∏–π
**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∏ –≤ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è—Ö –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–∏—Å–∞
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ–ø—Ü–∏–π –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ config
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
[i] –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ–ø—Ü–∏–π nfqws2...
[‚úì] –û–ø—Ü–∏–∏ nfqws2 –≤–∞–ª–∏–¥–Ω—ã
```

---

#### 5. DISABLE_IPV6=1 - –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è Keenetic
**–ü—Ä–æ–±–ª–µ–º–∞:** IPv6 –≤–∫–ª—é—á–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –Ω–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ Keenetic –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç IPv6
**–†–µ—à–µ–Ω–∏–µ:** DISABLE_IPV6=1 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ config
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```bash
# –í config –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
DISABLE_IPV6=1  # IPv6 –æ—Ç–∫–ª—é—á–µ–Ω –¥–ª—è Keenetic
```

---

#### 6. FLOWOFFLOAD=none - –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–∂–∏–º –¥–ª—è Keenetic
**–ü—Ä–æ–±–ª–µ–º–∞:** Flow offloading –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –º–æ–∂–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å nfqws
**–†–µ—à–µ–Ω–∏–µ:** FLOWOFFLOAD=none –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (nfqws –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º —Å offloading)
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```bash
# –í config –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
FLOWOFFLOAD=none  # –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–∂–∏–º
```

---

## ‚ùå –£–î–ê–õ–ï–ù–û: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –º–µ–Ω—é (–ø–µ—Ä–µ—Ö–æ–¥ –∫ –∞–≤—Ç–æ—É—Å—Ç–∞–Ω–æ–≤–∫–µ)

**–£–¥–∞–ª–µ–Ω–æ –∏–∑ `lib/menu.sh`:**
- –ü—É–Ω–∫—Ç –º–µ–Ω—é `[S] –°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏` (220 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞)
- –§—É–Ω–∫—Ü–∏–∏: `menu_system_settings()`, `menu_toggle_ipv6()`, `menu_configure_offload()`, `menu_configure_tmpdir()`

**–ü—Ä–∏—á–∏–Ω–∞:** z2k - —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫, –∞ –Ω–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä. –í—Å—ë –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –∏–∑ –∫–æ—Ä–æ–±–∫–∏.

---

## üìÅ –ò–ó–ú–ï–ù–Å–ù–ù–´–ï –§–ê–ô–õ–´

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
1. `lib/system_init.sh` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
2. `KEENETIC_RELEVANCE_ANALYSIS.md` - –∞–Ω–∞–ª–∏–∑ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
3. `IMPLEMENTATION_SUMMARY.md` - –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
4. `AUTOINSTALL_FIXES.md` - –ø–µ—Ä–µ—Ö–æ–¥ –∫ –∞–≤—Ç–æ—É—Å—Ç–∞–Ω–æ–≤–∫–µ
5. `FINAL_CHANGES_SUMMARY.md` - —ç—Ç–æ—Ç —Ñ–∞–π–ª

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
1. **z2k.sh** (2 –∏–∑–º–µ–Ω–µ–Ω–∏—è)
   - –î–æ–±–∞–≤–ª–µ–Ω `system_init` –≤ MODULES
   - –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ `init_system_vars()`

2. **lib/install.sh** (3 –¥–æ–±–∞–≤–ª–µ–Ω–∏—è)
   - `step_configure_tmpdir()` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä TMPDIR
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ crontab –≤ `step_finalize()`
   - –í—ã–∑–æ–≤ `step_configure_tmpdir()` –≤ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

3. **lib/config_official.sh** (3 –∏–∑–º–µ–Ω–µ–Ω–∏—è)
   - –í–∞–ª–∏–¥–∞—Ü–∏—è `dry_run_nfqws()`
   - DISABLE_IPV6=1 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
   - –°–µ–∫—Ü–∏—è TMPDIR –≤ config

4. **lib/menu.sh** (1 –∏–∑–º–µ–Ω–µ–Ω–∏–µ)
   - –£–¥–∞–ª–µ–Ω—ã –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (220 —Å—Ç—Ä–æ–∫)

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ë–ï–ó –≤–æ–ø—Ä–æ—Å–æ–≤:
sh z2k.sh install

# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
[i] –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Å–∏—Å—Ç–µ–º—ã...
[‚úì] –°–∏—Å—Ç–µ–º–∞: openwrt (init: procd)
[i] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
[i]   SYSTEM=openwrt
[i]   UNAME=Linux
[i]   INIT=procd
...
[‚úì] Low RAM —Å–∏—Å—Ç–µ–º–∞ - –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–∏—Å–∫ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
[‚úì] TMPDIR —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: /opt/zapret2/tmp (–∑–∞—â–∏—Ç–∞ –æ—Ç OOM)
...
[i] –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ–ø—Ü–∏–π nfqws2...
[‚úì] –û–ø—Ü–∏–∏ nfqws2 –≤–∞–ª–∏–¥–Ω—ã
...
[‚úì] –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 06:00)
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å cron
crontab -l | grep zapret
# –í—ã–≤–æ–¥: 0 6 * * * /opt/zapret2/ipset/get_config.sh

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å config
grep DISABLE_IPV6 /opt/zapret2/config
# –í—ã–≤–æ–¥: DISABLE_IPV6=1

grep FLOWOFFLOAD /opt/zapret2/config
# –í—ã–≤–æ–¥: FLOWOFFLOAD=none

grep TMPDIR /opt/zapret2/config
# –í—ã–≤–æ–¥ (low RAM): TMPDIR=/opt/zapret2/tmp
# –í—ã–≤–æ–¥ (normal RAM): #TMPDIR=/opt/zapret2/tmp
```

---

## üìä –°–†–ê–í–ù–ï–ù–ò–ï –î–û/–ü–û–°–õ–ï

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–û –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π | –ü–û–°–õ–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π |
|----------|----------------|-------------------|
| **–°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** | ‚ùå –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã | ‚úÖ –ê–≤—Ç–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ |
| **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** | ‚ùå –ù–µ—Ç cron | ‚úÖ Cron 06:00 (–∞–≤—Ç–æ) |
| **Low RAM –∑–∞—â–∏—Ç–∞** | ‚ùå /tmp OOM | ‚úÖ –ê–≤—Ç–æ –≤—ã–±–æ—Ä –ø–æ RAM |
| **–í–∞–ª–∏–¥–∞—Ü–∏—è –æ–ø—Ü–∏–π** | ‚ö†Ô∏è –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ | ‚úÖ –ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ |
| **IPv6** | ‚ö†Ô∏è –í–∫–ª—é—á–µ–Ω (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ) | ‚úÖ –û—Ç–∫–ª—é—á–µ–Ω (–ø—Ä–∞–≤–∏–ª—å–Ω–æ) |
| **Flow offloading** | ‚ö†Ô∏è –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω | ‚úÖ none (–±–µ–∑–æ–ø–∞—Å–Ω–æ) |
| **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** | ‚ö†Ô∏è –ú–µ–Ω—é –Ω–∞—Å—Ç—Ä–æ–µ–∫ | ‚úÖ –ê–≤—Ç–æ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ |

---

## ‚úÖ –ì–û–¢–û–í–ù–û–°–¢–¨ –ö –†–ï–õ–ò–ó–£

**–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** ‚úÖ 2/2 (100%)
**–í–∞–∂–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** ‚úÖ 4/4 (100%)
**–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:** ‚úÖ 100%

### –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å: **–ì–û–¢–û–í –ö ALPHA –†–ï–õ–ò–ó–£** üéâ

---

## üéØ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ï –ù–ê–°–¢–†–û–ô–ö–ò –î–õ–Ø KEENETIC

z2k –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –≤—Å—ë –¥–ª—è Keenetic —Ä–æ—É—Ç–µ—Ä–æ–≤:

| –ù–∞—Å—Ç—Ä–æ–π–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –õ–æ–≥–∏–∫–∞ |
|-----------|----------|--------|
| SYSTEM | openwrt | –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `check_system()` |
| UNAME | Linux | –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `uname -s` |
| INIT | procd | –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è Keenetic |
| FWTYPE | iptables | –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `linux_fwtype()` |
| DISABLE_IPV6 | 1 | –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ Keenetic –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç IPv6 |
| FLOWOFFLOAD | none | nfqws –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º —Å offloading |
| TMPDIR | –ê–≤—Ç–æ | RAM ‚â§400MB ‚Üí /opt/zapret2/tmp, –∏–Ω–∞—á–µ /tmp |

---

## üíæ GIT COMMIT MESSAGE

```
fix: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å install_easy.sh + –∞–≤—Ç–æ—É—Å—Ç–∞–Ω–æ–≤–∫–∞

–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–±–ª–æ–∫–µ—Ä—ã PRE-ALPHA ‚Üí ALPHA):
- –î–æ–±–∞–≤–ª–µ–Ω init_system_vars() –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ SYSTEM, UNAME, INIT
- –î–æ–±–∞–≤–ª–µ–Ω crontab_add() –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–æ–≤ (06:00)

–í–∞–∂–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (production –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å):
- step_configure_tmpdir() - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä TMPDIR –ø–æ RAM
- dry_run_nfqws() - –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ–ø—Ü–∏–π –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ config
- DISABLE_IPV6=1 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è Keenetic
- FLOWOFFLOAD=none –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–∂–∏–º)

–ü–µ—Ä–µ—Ö–æ–¥ –∫ –∞–≤—Ç–æ—É—Å—Ç–∞–Ω–æ–≤–∫–µ:
- –£–±—Ä–∞–Ω–æ –º–µ–Ω—é [S] –°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (220 —Å—Ç—Ä–æ–∫)
- step_configure_tmpdir() —Ä–∞–±–æ—Ç–∞–µ—Ç –ë–ï–ó –≤–æ–ø—Ä–æ—Å–æ–≤ —é–∑–µ—Ä—É
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–∏—Å—Ç–µ–º—ã

–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
- lib/system_init.sh - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- z2k.sh - –≤—ã–∑–æ–≤ init_system_vars()
- lib/install.sh - crontab, tmpdir –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- lib/config_official.sh - DISABLE_IPV6=1, –≤–∞–ª–∏–¥–∞—Ü–∏—è
- lib/menu.sh - —É–¥–∞–ª–µ–Ω—ã –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

z2k —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –¥–ª—è Keenetic –±–µ–∑ –ª–∏—à–Ω–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤.

Closes: #CRITICAL-FIXES-NEEDED
Refs: E:\Zapret2-keenetik\z2k-vs-official-critical-differences.md
Refs: E:\Zapret2-keenetik\AUTOINSTALL_FIXES.md

Co-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>
```

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

### –î–ª—è BETA —Ä–µ–ª–∏–∑–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

1. ‚è≥ fix_perms() - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª—ã
2. ‚è≥ default_files() - template —Ñ–∞–π–ª—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
3. ‚è≥ backup_restore_settings() - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–µ
4. ‚è≥ CUSTOM_DIR creation - –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è custom scripts

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ NICE TO HAVE (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç ALPHA —Ä–µ–ª–∏–∑)

---

**–ò—Ç–æ–≥:** z2k –≥–æ—Ç–æ–≤ –∫ –≤—ã—Ö–æ–¥—É –∏–∑ PRE-ALPHA –≤ ALPHA —Å—Ç–∞—Ç—É—Å! üéâ

–í—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º install_easy.sh —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã. z2k —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –¥–ª—è Keenetic, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –≤—Å—ë –ø—Ä–∞–≤–∏–ª—å–Ω–æ –±–µ–∑ –≤–æ–ø—Ä–æ—Å–æ–≤ —é–∑–µ—Ä—É.
